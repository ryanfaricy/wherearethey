@using Microsoft.Extensions.Localization
@using WhereAreThey.Models
@using WhereAreThey.Services.Interfaces
@inject DialogService DialogService
@inject ISettingsService SettingsService
@inject IStringLocalizer<App> L

<RadzenStack Gap="1.5rem" Class="rz-p-4">
    <RadzenStack Gap="0.5rem">
        <RadzenText TextStyle="TextStyle.H5" Style="font-weight: bold; color: var(--rz-primary);">@L["What_Is_This_Title"]</RadzenText>
        <RadzenText TextStyle="TextStyle.Body1">@L["What_Is_This_Desc"]</RadzenText>
    </RadzenStack>

    <hr style="border: none; border-top: 1px solid var(--rz-divider); margin: 0;" />

    <RadzenText TextStyle="TextStyle.H5" Style="font-weight: bold; color: var(--rz-primary);">@L["Quick_Help_Guide"]</RadzenText>

    <RadzenStack Gap="1rem">
        <RadzenText TextStyle="TextStyle.Subtitle1" Style="font-weight: bold;">@L["Map_Interactions"]</RadzenText>
        
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="touch_app" Style="color: var(--rz-info);" />
            <RadzenText TextStyle="TextStyle.Body2">
                <b>@L["Tap_Heat_Area"]:</b> @L["Tap_Heat_Area_Desc"]
            </RadzenText>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="add_location_alt" Style="color: var(--rz-warning);" />
            <RadzenText TextStyle="TextStyle.Body2">
                <b>@L["Tap_Empty_Area"]:</b> @L["Tap_Empty_Area_Desc"]
            </RadzenText>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="report_problem" Style="color: var(--rz-danger);" />
            <RadzenText TextStyle="TextStyle.Body2">
                <b>@L["Long_Press"]:</b> @L["Long_Press_Desc"]
            </RadzenText>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="notifications_active" Style="color: #e65100;" />
            <RadzenText TextStyle="TextStyle.Body2">
                <b>@L["Orange_Pins"]:</b> @L["Orange_Pins_Desc"]
            </RadzenText>
        </RadzenStack>
    </RadzenStack>

    <hr style="border: none; border-top: 1px solid var(--rz-divider); margin: 1rem 0;" />

    <RadzenStack Gap="1rem">
        <RadzenText TextStyle="TextStyle.Subtitle1" Style="font-weight: bold;">@L["Map_Controls_Title"]</RadzenText>
        
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="search" Style="color: var(--rz-base);" />
            <RadzenText TextStyle="TextStyle.Body2">@L["Search_Address_Desc"]</RadzenText>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="my_location" Style="color: var(--rz-primary);" />
            <RadzenText TextStyle="TextStyle.Body2">@L["Follow_Me_Desc"]</RadzenText>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="schedule" Style="color: var(--rz-info);" />
            <RadzenText TextStyle="TextStyle.Body2">@L["Time_Filters_Desc"]</RadzenText>
        </RadzenStack>
    </RadzenStack>

    <hr style="border: none; border-top: 1px solid var(--rz-divider); margin: 1rem 0;" />

    <RadzenStack Gap="1rem">
        <RadzenText TextStyle="TextStyle.Subtitle1" Style="font-weight: bold;">@L["Toolbar_Actions"]</RadzenText>
        
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenBadge Text="@L["REPORT"]" BadgeStyle="BadgeStyle.Danger" />
            <RadzenText TextStyle="TextStyle.Body2">@L["Report_Desc"]</RadzenText>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="notifications" Style="color: var(--rz-warning);" />
            <RadzenText TextStyle="TextStyle.Body2">@L["Alerts_Desc"]</RadzenText>
        </RadzenStack>

        @if (_settings.DonationsEnabled)
        {
            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                <RadzenIcon Icon="volunteer_activism" Style="color: var(--rz-success);" />
                <RadzenText TextStyle="TextStyle.Body2">@L["Donate_Desc"]</RadzenText>
            </RadzenStack>
        }

        <RadzenStack Gap="0.5rem">
            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                <RadzenIcon Icon="settings" Style="color: var(--rz-base);" />
                <RadzenText TextStyle="TextStyle.Body2">@L["Settings_Desc"]</RadzenText>
            </RadzenStack>
            
            <RadzenStack Gap="0.5rem" Class="rz-pl-8">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                    <RadzenIcon Icon="sync" Style="color: var(--rz-success);" Size="1rem" />
                    <RadzenText TextStyle="TextStyle.Caption">
                        <b>@L["Sync_Devices"]:</b> @L["Sync_Devices_Desc"]
                    </RadzenText>
                </RadzenStack>

                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                    <RadzenIcon Icon="get_app" Style="color: var(--rz-success);" Size="1rem" />
                    <RadzenText TextStyle="TextStyle.Caption">
                        <b>@L["INSTALL_APP"]:</b> @L["PWA_Install_Help"]
                    </RadzenText>
                </RadzenStack>
                
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
                    <RadzenIcon Icon="ios" Style="color: var(--rz-base);" Size="1rem" />
                    <RadzenText TextStyle="TextStyle.Caption">
                        <b>iOS:</b> @L["PWA_IOS_Install_Help"]
                    </RadzenText>
                </RadzenStack>
            </RadzenStack>
        </RadzenStack>

        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="1rem">
            <RadzenIcon Icon="refresh" Style="color: var(--rz-info);" />
            <RadzenText TextStyle="TextStyle.Body2">@L["Refresh_Desc"]</RadzenText>
        </RadzenStack>
    </RadzenStack>

    <hr style="border: none; border-top: 1px solid var(--rz-divider); margin: 1rem 0;" />

    <RadzenStack Gap="0.5rem">
        <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: bold;">@L["AntiSpam_Limits_Title"]</RadzenText>
        <RadzenText TextStyle="TextStyle.Body2">@L["AntiSpam_Limits_Desc"]</RadzenText>
        <RadzenStack Gap="0.25rem" Class="rz-pl-4">
            <RadzenText TextStyle="TextStyle.Caption">• @string.Format(L["Limit_Reports"].Value, _settings.ReportCooldownMinutes)</RadzenText>
            <RadzenText TextStyle="TextStyle.Caption">• @string.Format(L["Limit_Alerts"].Value, _settings.AlertLimitCount, _settings.ReportCooldownMinutes)</RadzenText>
            <RadzenText TextStyle="TextStyle.Caption">• @string.Format(L["Report_Expiry"].Value, _settings.ReportExpiryHours)</RadzenText>
        </RadzenStack>
    </RadzenStack>

    <RadzenText TextStyle="TextStyle.Caption" Class="opacity-75 rz-mt-2">
        @L["Privacy_Disclaimer"]
    </RadzenText>

    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="AlignItems.Center" Class="rz-mt-2">
        <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem">
            <RadzenButton Text="@L["PRIVACY"]" Click="@ShowPrivacyPolicy" ButtonStyle="ButtonStyle.Info" Size="ButtonSize.Small" Variant="Variant.Text" />
            <RadzenButton Text="@L["FEEDBACK"]" Click="@ShowFeedback" ButtonStyle="ButtonStyle.Info" Size="ButtonSize.Small" Variant="Variant.Text" />
        </RadzenStack>
        <RadzenButton Text="@L["GOT_IT"]" Click="@(() => DialogService.Close())" ButtonStyle="ButtonStyle.Primary" />
    </RadzenStack>
</RadzenStack>

@code {
    private SystemSettings _settings = new();

    protected override async Task OnInitializedAsync()
    {
        _settings = await SettingsService.GetSettingsAsync();
    }

    private async Task ShowPrivacyPolicy()
    {
        await DialogService.OpenAsync<PrivacyPolicyDialog>(L["PRIVACY_POLICY"], null, 
            DialogConfigs.Default);
    }

    private async Task ShowFeedback()
    {
        await DialogService.OpenAsync<FeedbackDialog>(L["FEEDBACK"], null, 
            DialogConfigs.Default);
    }
}
