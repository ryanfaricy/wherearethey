<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <ResourcePreloader />
    <link rel="stylesheet" href="@Assets["lib/bootstrap/dist/css/bootstrap.min.css"]" />
    <link rel="stylesheet" href="@Assets["app.css"]" />
    <link rel="stylesheet" href="@Assets["WhereAreThey.styles.css"]" />
    <link id="radzen-base-theme" rel="stylesheet" href="_content/Radzen.Blazor/css/material-base.css">
    <link id="radzen-theme" rel="stylesheet" href="_content/Radzen.Blazor/css/material.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="theme.js"></script>
    <script>
        // Immediate theme application to prevent flicker
        (function() {
            const stored = localStorage.getItem('app-theme');
            let actualTheme = 'light';
            if (!stored || stored === 'System' || stored === '2') {
                actualTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            } else if (stored === 'Dark' || stored === '1') {
                actualTheme = 'dark';
            }
            
            document.documentElement.setAttribute('data-theme', actualTheme);
            if (actualTheme === 'dark') {
                document.getElementById('radzen-base-theme').href = '_content/Radzen.Blazor/css/material-dark-base.css';
                document.getElementById('radzen-theme').href = '_content/Radzen.Blazor/css/material-dark.css';
            }
        })();
    </script>
    <ImportMap />
    <link rel="icon" type="image/png" href="favicon.png" />
    <HeadOutlet @rendermode="InteractiveServer" />
</head>

<body>
    <Routes @rendermode="InteractiveServer" />
    <ReconnectModal />
    <script src="@Assets["_framework/blazor.web.js"]"></script>
    <script src="_content/Radzen.Blazor/Radzen.Blazor.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    <script src="geolocation.js"></script>
    <script src="heatmap.js"></script>
</body>

</html>
